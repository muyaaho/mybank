# Default values for mybank-infrastructure
# Override these values for different environments (dev/staging/prod)

global:
  namespace: mybank
  storageClass: standard  # Kind default storage class

# PostgreSQL for auth-service and user-service
postgres:
  enabled: true

  auth:
    enabled: true
    name: postgres-auth
    port: 5432
    database: mybank_auth
    username: mybank
    password: mybank123
    replicas: 1
    image:
      repository: postgres
      tag: "16-alpine"
      pullPolicy: IfNotPresent
    resources:
      requests:
        memory: "256Mi"
        cpu: "250m"
      limits:
        memory: "512Mi"
        cpu: "500m"
    persistence:
      enabled: true
      size: 1Gi
      accessMode: ReadWriteOnce

  user:
    enabled: true
    name: postgres-user
    port: 5433
    database: mybank_user
    username: mybank_user
    password: mybank_user123
    replicas: 1
    image:
      repository: postgres
      tag: "16-alpine"
      pullPolicy: IfNotPresent
    resources:
      requests:
        memory: "256Mi"
        cpu: "250m"
      limits:
        memory: "512Mi"
        cpu: "500m"
    persistence:
      enabled: true
      size: 1Gi
      accessMode: ReadWriteOnce

# MongoDB for asset, analytics, payment, investment services
mongodb:
  enabled: true
  name: mongodb
  port: 27017
  replicas: 1

  # Root credentials
  rootUsername: root
  rootPassword: rootpassword

  # Application credentials
  username: mybank
  password: mybank123
  authDatabase: admin

  # Databases
  databases:
    - mybank_pfm
    - mybank_payment
    - mybank_investment

  image:
    repository: mongo
    tag: "7"
    pullPolicy: IfNotPresent

  resources:
    requests:
      memory: "512Mi"
      cpu: "500m"
    limits:
      memory: "1Gi"
      cpu: "1000m"

  persistence:
    enabled: true
    size: 2Gi
    accessMode: ReadWriteOnce

# Redis for caching and sessions
redis:
  enabled: true
  name: redis
  port: 6379
  replicas: 1

  # No password for local dev (set password for prod)
  password: ""

  image:
    repository: redis
    tag: "7-alpine"
    pullPolicy: IfNotPresent

  resources:
    requests:
      memory: "128Mi"
      cpu: "100m"
    limits:
      memory: "256Mi"
      cpu: "200m"

  persistence:
    enabled: false  # Redis is cache, no persistence needed in dev

# Kafka for event-driven architecture
kafka:
  enabled: true
  name: kafka
  port: 9092
  replicas: 1

  # KRaft mode (no Zookeeper)
  clusterId: "REQ0OUQ4NUVGNkE2NDkxRD"

  image:
    repository: apache/kafka
    tag: "latest"
    pullPolicy: IfNotPresent

  resources:
    requests:
      memory: "1Gi"
      cpu: "500m"
    limits:
      memory: "2Gi"
      cpu: "1000m"

  persistence:
    enabled: true
    size: 5Gi
    accessMode: ReadWriteOnce

  # Topics configuration
  topics:
    - name: payment-completed
      partitions: 3
      replicationFactor: 1
    - name: investment-executed
      partitions: 3
      replicationFactor: 1
    - name: user-registered
      partitions: 3
      replicationFactor: 1

# Monitoring (optional)
monitoring:
  enabled: false

  prometheus:
    enabled: false
    port: 9090

  grafana:
    enabled: false
    port: 3001
